<!DOCTYPE html>
<html lang="en-US">

<head>
	<title>Switch</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link href="https://www.w3schools.com/w3css/4/w3.css" rel="stylesheet">
	<link href="https://www.w3schools.com/lib/w3-theme-black.css" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Roboto:100" rel="stylesheet">
	<link href="favicon.ico" rel="icon" type="image/x-icon">
	<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
	<script>
		getStartData();
		makeButtons();
		getSwitchStatus();

		function makeButtons() {
			$.get("/names.json", function (data) {
				var items = [];
				$.each(data, function (index, value) {
					items.push('<button id="' + index + '" class="w3-bar-item w3-quarter" style="text-align: center; width:25%;">' + value + '</button>');
				});
				items.push('<div class="w3-section w3-center"><button id="_save" type=submit class="w3-button w3-round-xlarge w3-padding-small"></button></div>');
				items.join("");
				$('#btnWALL').append(items);
			});
		}

		function getStartData() {
			$.get("/JSONSTART", function (data) {
				$.each(data, function (index, value) {
					$('#' + index).html(value);
				});
			});
		}

		function getSwitchStatus() {
			$.get("/SWITCHSTATUS", function (data) {
				$(".w3-bar-item").each(function () {
					var index = $(this).attr("id");
					if (data[index] == 1) {
						$("#" + index).removeClass("w3-red");
						$("#" + index).addClass("w3-green");
					}
					else $("#" + index).addClass("w3-red");
				});
				$(".w3-bar-item").click(function () {
					var b = $(this).attr("id");
					var a;
					if ($(this).hasClass("w3-green")) {
						a = 0;
						$(this).removeClass("w3-green");
						$(this).addClass("w3-red");
					} else if ($(this).hasClass("w3-red")) {
						a = 1;
						$(this).removeClass("w3-red");
						$(this).addClass("w3-green");
					}
					$.get("/switchu?c=" + b + a);
					// setTimeout(function () { getSwitchStatus(); }, 5000);
				});
			});
		}

		function populatePre(a) {
			var b = new XMLHttpRequest();
			b.onreadystatechange = function () {
				if (this.readyState == 4 && this.status == 200) {
					document.getElementById("SwitchResponse").textContent = this.responseText;
				}
			};
			b.open("GET", a, true);
			b.send();
		}
	</script>
	<style>
		body,
		button,
		pre,
		h1 {
			font-family: "Roboto", sans-serif;
			margin: 0;
			padding: 0
		}

		.w3-bar-item {
			height: 15vmax;
		}

		.content {
			margin: auto;
		}
	</style>
</head>

<body class="content w3-theme-dark w3-mobile">
	<div style="text-align: center">
		<h1><span id="title">BoxID</span></h1>
	</div>
	<hr class="w3-border-grey">
	<div class="w3-padding-small w3-block" id="btnWALL"></div>
	<hr class="w3-border-grey">
	<div class="w3-section w3-center">
		<div>
			<a id="btnSettings" href="/SETTINGS"
				class="w3-button w3-round-xlarge w3-padding-small">Settings</a>
			<a id="btnRestart" href="/RESTART"
				class="w3-button w3-round-xlarge w3-padding-small">Restart</a>
		</div>
		<span id="version">Version</span>
	</div>
</body>

</html>